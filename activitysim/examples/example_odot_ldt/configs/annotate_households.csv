Description,Target,Expression
# ,,"description describes the field, unimportant in actual program, target refers to the actual variable reference, expression is the value of the target"
#,, annotate households table after import
,_PERSON_COUNT,"lambda query, persons, households: persons.query(query).groupby('household_id').size().reindex(households.index).fillna(0).astype(np.int8)"
number of workers,num_workers,"_PERSON_COUNT('ESR==2 | ESR==5', persons, households)"
number of students,num_students,"_PERSON_COUNT('SCH>=2', persons, households)"
number of drivers,num_drivers,"_PERSON_COUNT('16 <= AGE', persons, households)"
#,,FIXME households.income can be negative  - so we clip?
income_in_thousands,income_in_thousands,(households.INCOME / 1000).clip(lower=0)
